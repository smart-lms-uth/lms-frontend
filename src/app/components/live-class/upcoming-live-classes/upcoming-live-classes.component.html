<div class="upcoming-card">
  <div class="card-header">
    <h3 class="card-title">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="23 7 16 12 23 17 23 7"></polygon>
        <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
      </svg>
      Lớp học trực tuyến
    </h3>
  </div>

  <div class="card-content">
    <!-- Loading -->
    <div *ngIf="loading()" class="loading-state">
      <div class="spinner-small"></div>
      <span>Đang tải...</span>
    </div>

    <div *ngIf="!loading()">
      <!-- Live Now - Most Important -->
      <div *ngIf="liveNowClasses().length > 0" class="live-now-section">
        <div *ngFor="let lc of liveNowClasses()" class="live-item live-item--active">
          <div class="live-item__badge">
            <span class="live-indicator"></span>
            <app-badge variant="success">LIVE</app-badge>
          </div>
          <h4 class="live-item__title">{{ lc.title }}</h4>
          <p class="live-item__course">{{ lc.courseName }}</p>
          <div class="live-item__actions">
            <button class="btn btn--primary btn--sm" (click)="joinClass(lc)">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
              </svg>
              {{ isTeacher() ? 'Vào lớp' : 'Tham gia' }}
            </button>
          </div>
        </div>
      </div>

      <!-- Upcoming Classes -->
      <div *ngIf="upcomingClasses().length > 0" class="upcoming-section">
        <div *ngFor="let lc of upcomingClasses()" class="live-item">
          <div class="live-item__header">
            <span class="live-item__time" [class.soon]="canJoin(lc)">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              {{ getTimeUntil(lc.scheduledAt) }}
            </span>
          </div>
          <h4 class="live-item__title">{{ lc.title }}</h4>
          <p class="live-item__course">{{ lc.courseName }}</p>
          <p class="live-item__date">{{ formatDateTime(lc.scheduledAt) }}</p>
          <div class="live-item__actions" *ngIf="canJoin(lc)">
            <button class="btn btn--outline btn--sm" (click)="joinClass(lc)">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
              </svg>
              Vào phòng chờ
            </button>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="liveNowClasses().length === 0 && upcomingClasses().length === 0" class="empty-state">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <polygon points="23 7 16 12 23 17 23 7"></polygon>
          <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
        </svg>
        <p>Không có lớp học sắp tới</p>
      </div>
    </div>
  </div>
</div>
